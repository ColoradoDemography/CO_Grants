!function(t){function r(o){if(e[o])return e[o].exports;var a=e[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}var e={};return r.m=t,r.c=e,r.p="dest",r(0)}([function(t,r,e){"use strict";importScripts("https://d3js.org/d3.v3.min.js");var o=e(4),a=e(1).sortNumeric,n=e(2),s=e(3);onmessage=function(t){console.log("Message received from main script");var r=[],e=[];d3.csv("https://storage.googleapis.com/co-publicdata/grantpts.csv",function(t){d3.csv("https://storage.googleapis.com/co-publicdata/keypts.csv",function(i){i.forEach(function(t){-1===r.indexOf(t.govname)&&(r.push(t.govname),e.push([parseFloat(t.longitude),parseFloat(t.latitude)]),r.push(t.lgid),e.push([parseFloat(t.longitude),parseFloat(t.latitude)])),"EIAF"===t.program&&t.projectnmbr>0&&-1===r.indexOf("#"+t.projectnmbr)&&(r.push("#"+t.projectnmbr),e.push([parseFloat(t.longitude),parseFloat(t.latitude)])),"EIAF"===t.program&&t.projectnmbr>0&&-1===r.indexOf("#"+t.projectnmbr)&&(r.push("#"+t.projectnmbr),e.push([parseFloat(t.longitude),parseFloat(t.latitude)]))});var u=t.map(function(t){return n(t,r,e,i)}),p=s(u);p.forEach(function(t){return o(t)}),p=p.sort(a),console.log("Posting message back to main script"),postMessage([p,r,e]),close()})})}},function(t,r){"use strict";t.exports.formatMoney=function(t,r,e){var o=this,a=isNaN(t=Math.abs(t))?2:t,n=void 0==r?".":r,s=void 0==e?",":e,i=0>o?"-":"",u=parseInt(o=Math.abs(+o||0).toFixed(a))+"",p=(p=u.length)>3?p%3:0;return i+(p?u.substr(0,p)+s:"")+u.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+s)+(a?n+Math.abs(o-u).toFixed(a).slice(2):"")},t.exports.sortNumeric=function(t,r){return t.id<r.id?1:-1},t.exports.monthNumStr=function(t){return"JAN"===t?0:"FEB"===t?1:"MAR"===t?2:"APR"===t?3:"MAY"===t?4:"JUN"===t?5:"JUL"===t?6:"AUG"===t?7:"SEP"===t?8:"OCT"===t?9:"NOV"===t?10:"DEC"===t?11:(console.log("unexpected fall through on monthNumStr"),99)}},function(t,r,e){"use strict";var o=e(1).monthNumStr;t.exports=function(t,r,e,a){function n(r,e,o){return o[e].lgid===t.lgid?!0:void 0}"FML_SB106"===t.program&&(t.program="FML");var s=t.dateofaward.split("-"),i=new Date(Number("20"+s[2]),o(s[1]),Number(s[0]));"null"===t.projectnmbr&&(t.projectnmbr=""),"null"===t.projname&&(t.projname=t.program+" Distribution");var u=a.findIndex(n);if(u>-1){var p={};return p.award=parseFloat(t.award),p.dateofaward=i,p.govname=a[u].govname,p.latitude=parseFloat(a[u].latitude),p.longitude=parseFloat(a[u].longitude),p.lgid=t.lgid,p.lgtype=parseInt(a[u].lgtype,10),p.program=t.program,p.projectnmbr=t.projectnmbr,p.projname=t.projname,p}console.log("problem?")}},function(t,r){"use strict";t.exports=function(t){var r=[],e=t.map(function(t){var e=t.lgid;r.hasOwnProperty(e)?r[e]++:r[e]=0;var o=t.latitude+.002*r[e],a=t.longitude;return t.latLng=[o,a],t});return e}},function(t,r){"use strict";var e=[];t.exports=function(t){function r(t){var r=(t-o)/864e5;return r}var o=new Date(2e3,0,1);-1===e.indexOf(t.lgid)&&e.push(t.lgid);var a=e.indexOf(t.lgid),n=1e8*a,s=t.program;"DR"===s&&(n+=1e5),"FML"===s&&(n+=12e5),"CTF"===s&&(n+=11e5),"SEV_DIST"===s&&(n+=1e6),"CSBG"===s&&(n+=6e5),"CDBG"===s&&(n+=5e5),"EIAF"===s&&(n+=2e5),"GAME"===s&&(n+=3e5),"REDI"===s&&(n+=4e5),"VFP"===s&&(n+=8e5),"SAR"===s&&(n+=7e5),"FFB"===s&&(n+=9e5);var i=Math.random();return n=n+r(t.dateofaward)+i,t.id=n,t}}]);